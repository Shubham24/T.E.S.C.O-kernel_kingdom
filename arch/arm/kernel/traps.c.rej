--- arch/arm/kernel/traps.c	2012-04-27 18:52:09.000000000 +0200
+++ arch/arm/kernel/traps.c	2012-06-17 20:23:33.000000000 +0200
@@ -451,7 +451,9 @@
 		if (end > vma->vm_end)
 			end = vma->vm_end;
 
-		flush_cache_user_range(vma, start, end);
+		up_read(&mm->mmap_sem);
+		flush_cache_user_range(start, end);
+		return;
 	}
 	up_read(&mm->mmap_sem);
 }
